USE Galvez_DB

CREATE TABLE DEPARTMENT (
    DEPTNO CHAR(3) PRIMARY KEY,
    DEPTNAME VARCHAR(50),
    MGRNO CHAR(6),
    ADMRDEPT CHAR(3),
    LOCATION VARCHAR(50)
);

INSERT INTO DEPARTMENT (DEPTNO, DEPTNAME, MGRNO, ADMRDEPT, LOCATION)
VALUES
('A00', 'SPIFFY COMPUTER SERVICE DIV.', '000010', 'A00', 'ADMIN BLDG. 1ST FLOOR'),
('B01', 'PLANNING', '000020', 'A00', 'ADMIN BLDG. 2ND FLOOR'),
('C01', 'INFORMATION CENTER', '000030', 'A00', 'ADMIN BLDG. GROUND FLOOR'),
('D01', 'DEVELOPMENT CENTER', NULL, 'A00', 'DEV BLDG. GROUND AND 1ST FLOOR'),
('D11', 'MANUFACTURING SYSTEMS', '000060', 'D01', 'DEV BLDG. 2ND, 3RD, AND 4TH FLOOR'),
('D21', 'ADMINISTRATION SYSTEMS', '000070', 'D01', 'ADMIN BLDG. 1ST FLOOR NORTH-WING'),
('E01', 'SUPPORT SERVICES', '000050', 'A00', 'ADMIN BLDG. 1ST FLOOR WEST-WING'),
('E11', 'OPERATIONS', '000090', 'E01', NULL),
('E21', 'SOFTWARE SUPPORT', '000100', 'E01', 'DEV BLDG. 5TH-7TH FLOOR'),
('F22', 'BRANCH OFFICE F2', NULL, 'E01', NULL),
('G22', 'BRANCH OFFICE G2', NULL, 'E01', NULL),
('H22', 'BRANCH OFFICE H2', NULL, 'E01', NULL),
('I22', 'BRANCH OFFICE I2', NULL, 'E01', NULL),
('J22', 'BRANCH OFFICE J2', NULL, 'E01', NULL);


CREATE TABLE EMPLOYEE (
    EMPNO CHAR(6) PRIMARY KEY,
    FIRSTNAME VARCHAR(20),
    MIDINIT CHAR(1),
    LASTNAME VARCHAR(20),
    WORKDEPT CHAR(3),
    PHONENO VARCHAR(15),
    HIREDATE DATE,
    JOB VARCHAR(20),
    EDLEVEL SMALLINT,
    GENDER CHAR(1),
    BIRTHDATE DATE,
    SALARY DECIMAL(9, 2),
    BONUS DECIMAL(9, 2),
    COMM DECIMAL(9, 2)
);


INSERT INTO EMPLOYEE (EMPNO, FIRSTNAME, MIDINIT, LASTNAME, WORKDEPT, PHONENO, HIREDATE, JOB, EDLEVEL, GENDER, BIRTHDATE, SALARY, BONUS, COMM) 
VALUES
('000010', 'CHRISTINE', 'I', 'HAAS', 'A00', '08131233978', '1995-01-01', 'PRESIDENT', 18, 'F', '1963-08-24', 152750.00, 1000.00, 4220.00),
('000020', 'MICHAEL', 'L', 'THOMPSON', 'B01', '09082453476', '2003-10-10', 'MANAGER', 18, 'M', '1978-02-02', 94250.00, 800.00, 3300.00),
('000030', 'SALLY', 'A', 'KWAN', 'C01', '09112544738', '2005-04-05', 'MANAGER', 20, 'F', '1971-05-11', 98250.00, 800.00, 3060.00),
('000050', 'JOHN', 'B', 'GEYER', 'E01', '09136546789', '1979-08-17', 'MANAGER', 16, 'M', '1955-09-15', 80175.00, 800.00, 3214.00),
('000060', 'IRVING', 'F', 'STERN', 'D11', '09196576423', '2003-09-14', 'MANAGER', 16, 'M', '1975-07-07', 72250.00, 500.00, 2580.00),
('000070', 'EVA', 'D', 'PULASKI', 'D21', '09217857831', '2005-09-30', 'MANAGER', 16, 'F', '2003-05-26', 96170.00, 700.00, 2893.00),
('000090', 'EILEEN', 'W', 'HENDERSON', 'E11', '09286855498', '2000-08-15', 'MANAGER', 16, 'F', '1971-05-15', 89750.00, 600.00, 2380.00),
('000100', 'THEODORE', 'Q', 'SPENSER', 'E21', '09468740972', '2000-06-19', 'MANAGER', 14, 'M', '1980-12-18', 86150.00, 500.00, 2092.00),
('000110', 'VINCENZO', 'G', 'LUCCHESSI', 'A00', '09473653490', '1988-05-16', 'SALESREP', 19, 'M', '1959-11-05', 66500.00, 900.00, 3720.00),
('000120', 'SEAN', NULL, 'O''CONNELL', 'A00', '08173542167', '1993-12-05', 'CLERK', 14, 'M', '1972-10-18', 49250.00, 600.00, 2340.00),
('000130', 'DELORES', 'M', 'QUINTANA', 'C01', '09042574578', '2001-07-28', 'ANALYST', 16, 'F', '1955-09-15', 73800.00, NULL, 1904.00),
('000140', 'HEATHER', 'A', 'NICHOLLS', 'C01', '09157411793', '2006-12-15', 'ANALYST', 18, 'F', '1976-01-19', 68420.00, 600.00, 2274.00),
('000150', 'BRUCE', NULL, 'ADAMSON', 'D11', '09175244510', '2002-02-12', 'DESIGNER', 16, 'M', '1977-05-17', 55280.00, 500.00, 2022.00),
('000160', 'ELIZABETH', 'R', 'PIANKA', 'D11', '09365473782', '2006-10-11', 'DESIGNER', 17, 'F', '1980-04-12', 62250.00, 400.00, 1780.00),
('000170', 'MASATOS', 'J', 'YOSHIMURA', 'D11', '09542582890', '1999-09-15', 'DESIGNER', 16, 'M', '1981-01-05', 44680.00, 500.00, 1974.00),
('000180', 'MARILYN', 'S', 'SCOUTTEN', 'D11', '90552141682', '2003-07-07', 'DESIGNER', 17, 'F', '1979-02-21', 51340.00, 500.00, 1707.00),
('000190', 'JAMES', 'H', 'WALKER', 'D11', '09765482986', '2004-07-26', 'DESIGNER', 16, 'M', '1982-06-25', 50450.00, 400.00, 1636.00),
('000200', 'DAVID', NULL, 'BROWN', 'D11', '08982144501', '2002-03-03', 'DESIGNER', 16, 'M', '1971-05-29', 57740.00, 600.00, 2217.00),
('000210', 'WILLIAM', 'T', 'JONES', 'D11', '08974570942', '1998-04-11', 'DESIGNER', 17, 'M', '2003-02-23', 68270.00, 400.00, 1462.00),
('000220', 'JENNIFER', 'K', 'LUTZ', 'D11', '09921480672', '1998-08-29', 'DESIGNER', 18, 'F', '1978-03-19', 49840.00, 600.00, 2387.00),
('000230', 'JAMES', 'J', 'JEFFERSON', 'D21', '09942502094', '1996-11-21', 'CLERK', 14, 'M', '1980-05-30', 42180.00, 400.00, 1774.00),
('000240', 'SALVATO', 'M', 'MARINO', 'D21', '09075843780', '2004-12-05', 'CLERK', 17, 'M', '2002-03-31', 48760.00, 600.00, 2301.00),
('000250', 'DANIEL', 'S', 'SMITH', 'D21', '09102540961', '1999-10-30', 'CLERK', 15, 'M', '1969-11-12', 49180.00, 400.00, 1534.00),
('000260', 'SYBIL', 'P', 'JOHNSON', 'D21', '09918368953', '2005-09-11', 'CLERK', 16, 'F', '1976-10-05', 47250.00, 300.00, 1380.00),
('000270', 'MARIA', 'L', 'PEREZ', 'D21', '09301239001', '2006-09-30', 'CLERK', 15, 'F', '2003-05-26', 37380.00, 500.00, 2190.00),
('000280', 'ETHEL', 'R', 'SCHNEIDER', 'E11', '09386178997', '1997-03-24', 'OPERATOR', 17, 'F', '1976-03-28', 36250.00, 500.00, 2100.00),
('000290', 'JOHN', 'R', 'PARKER', 'E11', '09468124502', '2006-05-30', 'OPERATOR', 12, 'M', '1985-07-09', 35340.00, 300.00, 1227.00),
('000300', 'PHILIP', 'X', 'SMITH', 'E11', '09486572095', '2002-06-19', 'OPERATOR', 14, 'M', '1976-10-27', 37750.00, 400.00, NULL),
('000310', 'MAUDE', 'F', 'SETRIGHT', 'E11', '09502343332', '1994-09-12', 'OPERATOR', 12, 'F', '1961-04-21', 35900.00, 300.00, 1272.00),
('000320', 'RAMLAL', 'V', 'MEHTA', 'E21', '09635479990', '1995-07-07', 'FIELDREP', 16, 'M', '1962-08-11', 39950.00, 400.00, 1596.00),
('000330', 'WING', NULL, 'LEE', 'E21', '09895742103', '2006-02-23', 'FIELDREP', 14, 'M', '1971-07-18', 45370.00, 500.00, 2030.00),
('000340', 'JASON', 'R', 'GOUNOT', 'E21', '09987525698', '1977-05-05', 'FIELDREP', 16, 'M', '1956-05-17', 43840.00, 500.00, 1907.00),
('200010', 'DIAN', 'J', 'HEMMINGER', 'A00', '09051423978', '1995-01-01', 'SALESREP', 18, 'F', '1973-08-14', 46500.00, 1000.00, 4220.00),
('200120', 'GREG', NULL, 'ORLANDO', 'A00', '09112582167', '2002-05-05', 'CLERK', 14, 'M', '1972-10-18', 39250.00, 600.00, 2340.00),
('200140', 'KIM', 'N', 'NATZ', 'C01', '09175321793', '2006-12-15', 'ANALYST', 18, 'F', '1976-01-19', 68420.00, NULL, 2274.00),
('200170', 'KIYOSHI', NULL, 'YAMAMOTO', 'D11', '09548722890', '2005-09-15', 'DESIGNER', 16, 'M', '1981-01-05', 64680.00, 500.00, 1974.00),
('200220', 'REBA', 'K', 'JOHN', 'D11', '09284570672', '2005-08-29', 'DESIGNER', 18, 'F', '1978-03-19', 69840.00, 600.00, 2387.00),
('200240', 'ROBERT', 'M', 'MONTEVER', 'D21', '09244783780', '2004-12-05', 'CLERK', 17, 'M', '1984-03-31', 37760.00, 600.00, 2301.00),
('200280', 'EILEEN', 'R', 'SCHWARTZ', 'E11', '09892148997', '1997-03-24', 'OPERATOR', 17, 'F', '1966-03-28', 46250.00, 500.00, 2100.00),
('200310', 'MICHELLE', 'F', 'SPRINGER', 'E11', '09375483332', '1994-09-12', 'OPERATOR', 12, 'F', '1961-04-21', 35900.00, 300.00, NULL),
('200330', 'HELENA', NULL, 'WONG', 'E21', '09094522103', '2006-02-23', 'FIELDREP', 14, 'F', '1971-07-18', 35370.00, 500.00, 2030.00),
('200340', 'ROY', 'R', 'ALONZO', 'E21', '09152475698', '1997-07-05', 'FIELDREP', 16, 'M', '1956-05-17', 31840.00, 500.00, 1907.00);




CREATE TABLE PROJECT (
    PROJNO CHAR(6) PRIMARY KEY,
    PROJNAME VARCHAR(50),
    DEPTNO CHAR(3),
    RESPEMP CHAR(6),
    PRSTAFF DECIMAL(5, 2),
    PRSTDATE DATE,
    PRENDATE DATE,
    MAJPROJ CHAR(6)
);


INSERT INTO PROJECT (PROJNO, PROJNAME, DEPTNO, RESPEMP, PRSTAFF, PRSTDATE, PRENDATE, MAJPROJ) 
VALUES
('AD3100', 'ADMIN SERVICES', 'D01', '000010', 6.50, '2021-01-01', '2023-02-01', NULL),
('AD3110', 'GENERAL ADMIN SYSTEMS', 'D21', '000070', 6.00, '2019-05-01', '2022-02-01', 'AD3100'),
('AD3111', 'PAYROLL PROGRAMMING', 'D21', '000230', 2.00, '2020-03-01', '2022-02-01', 'AD3110'),
('AD3112', 'PERSONNEL PROGRAMMING', 'D21', '000250', 1.00, '2018-04-01', '2021-02-01', 'AD3110'),
('AD3113', 'ACCOUNT PROGRAMMING', 'D21', '000270', 2.00, '2018-06-01', '2022-02-01', 'AD3110'),
('IF1000', 'QUERY SERVICES', 'C01', '000030', 2.00, '2020-01-01', '2021-02-01', NULL),
('IF2000', 'USER EDUCATION', 'C01', '000030', 1.00, '2020-04-01', '2021-02-01', NULL),
('MA2100', 'WELD LINE AUTOMATION', 'D01', '000010', 12.00, '2021-10-01', '2023-02-01', NULL),
('MA2110', 'W L PROGRAMMING', 'D11', '000060', 9.00, '2018-08-01', '2020-02-01', 'MA2100'),
('MA2111', 'W L PROGRAM DESIGN', 'D11', '000220', 2.00, '2019-01-01', '2020-12-01', 'MA2110'),
('MA2112', 'W L ROBOT DESIGN', 'D11', '000150', 3.00, '2020-01-01', '2021-12-01', 'MA2110'),
('MA2113', 'W L PROD CONT PROGS', 'D11', '000160', 3.00, '2017-02-15', '2019-12-01', 'MA2110'),
('OP1000', 'OPERATION SUPPORT', 'E01', '000050', 6.00, '2019-01-01', '2020-02-01', NULL),
('OP1010', 'OPERATION', 'E11', '000090', 5.00, '2020-04-01', '2021-02-01', 'OP1000'),
('OP2000', 'GEN SYSTEMS SERVICES', 'E01', '000050', 5.00, '2017-01-01', '2019-02-01', NULL),
('OP2010', 'SYSTEMS SUPPORT', 'E21', '000100', 4.00, '2020-05-01', '2021-02-01', 'OP2000'),
('OP2011', 'SCP SYSTEMS SUPPORT', 'E21', '000320', 1.00, '2018-07-01', '2020-02-01', 'OP2010'),
('OP2012', 'APPLICATIONS SUPPORT', 'E21', '000330', 1.00, '2018-09-01', '2021-02-01', 'OP2010'),
('OP2013', 'DB/DC SUPPORT', 'E21', '000340', 1.00, '2020-02-01', '2022-02-01', 'OP2010'),
('PL2100', 'WELD LINE PLANNING', 'B01', '000020', 1.00, '2017-07-01', '2020-09-15', 'MA2100');



DROP TABLE IF EXISTS EMP_ACT;


create table EMP_ACT(
	EMPNO CHAR(6),
	PROJNO CHAR(6),
	ACTNO SMALLINT,
	EMPTIME DECIMAL(3,2),
	EMSTDATE DATE,
	EMENDATE DATE
);

INSERT INTO EMP_ACT (EMPNO, PROJNO, ACTNO, EMPTIME, EMSTDATE, EMENDATE)
VALUES
	('000010', 'AD3100', 10, 0.50, '2021-01-05', '2023-01-29'),
	('000070', 'AD3110', 10, 1.00, '2019-05-15', '2022-02-20'),
	('000230', 'AD3111', 60, 1.00, '2020-03-10', '2022-01-15'),
	('000230', 'AD3111', 60, 0.50, '2020-03-15', '2022-01-15'),
	('000230', 'AD3111', 70, 0.50, '2020-03-15', '2022-01-20'),
	('000230', 'AD3111', 80, 0.50, '2020-03-15', '2022-01-20'),
	('000230', 'AD3111', 180, 0.50, '2020-03-15', '2022-01-15'),
	('000240', 'AD3111', 70, 1.00, '2020-04-15', '2022-01-25'),
	('000240', 'AD3111', 80, 1.00, '2020-04-15', '2022-01-25'),
	('000250', 'AD3112', 60, 1.00, '2018-04-04', '2021-02-01'),
	

	('000250', 'AD3112', 60, 0.50, '2018-04-10', '2021-03-15'),
	('000250', 'AD3112', 60, 1.00, '2018-04-01', '2021-02-01'),
	('000250', 'AD3112', 70, 0.50, '2018-05-01', '2021-03-15'),
	('000250', 'AD3112', 70, 1.00, '2018-05-15', '2021-08-15'),
	('000250', 'AD3112', 70, 0.25, '2018-05-15', '2023-09-15'),
	('000250', 'AD3112', 80, 0.25, '2018-05-15', '2021-08-15'),
	('000250', 'AD3112', 80, 0.50, '2018-05-20', '2021-10-01'),
	('000250', 'AD3112', 180, 0.50, '2018-05-20', '2021-03-01'),
	('000260', 'AD3113', 70, 0.50, '2018-06-15', '2022-07-01'),
	('000260', 'AD3113', 70, 1.00, '2018-07-01', '2022-02-01'),

    ('000260', 'AD3113', 80, 1.00, '2018-06-10', '2022-03-01'),
    ('000260', 'AD3113', 80, 0.50, '2018-07-01', '2022-04-15'),
    ('000260', 'AD3113', 180, 0.50, '2018-08-01', '2022-04-15'),
    ('000260', 'AD3113', 180, 1.00, '2018-08-15', '2022-06-01'),
    ('000260', 'AD3113', 180, 1.00, '2018-08-01', '2022-07-01'),
    ('000270', 'AD3113', 60, 0.50, '2018-07-01', '2022-04-01'),
    ('000270', 'AD3113', 60, 1.00, '2018-07-10', '2022-09-01'),
    ('000270', 'AD3113', 60, 0.25, '2018-09-01', '2022-10-15'),
    ('000270', 'AD3113', 70, 0.75, '2018-09-01', '2022-10-15'),
    ('000270', 'AD3113', 70, 1.00, '2018-10-15', '2022-02-01'),
    
	--31
	('000270', 'AD3113', 80, 1.00, '2018-10-01', '2022-03-01'),
    ('000270', 'AD3113', 80, 0.50, '2018-10-01', '2022-04-01'),
    ('000030', 'IF1000', 10, 0.50, '2020-01-15', '2021-01-30'),
    ('000130', 'IF1000', 90, 1.00, '2020-01-15', '2021-01-25'),
    ('000130', 'IF1000', 100, 0.50, '2020-02-01', '2021-01-30'),
	
	('000140', 'IF1000', 90, 0.50, '2020-02-01', '2021-01-25'),
    ('000030', 'IF2000', 10, 0.50, '2020-01-10', '2021-01-15'),
    ('000140', 'IF2000', 100, 1.00, '2020-01-10', '2021-01-15'),
    ('000140', 'IF2000', 100, 0.50, '2020-03-01', '2021-01-25'),
    ('000140', 'IF2000', 110, 0.50, '2020-03-01', '2021-01-30'),
    
	--41
	('000140', 'IF2000', 110, 0.50, '2020-02-01', '2021-01-30'),
    ('000010', 'MA2100', 10, 0.50, '2021-10-10', '2023-01-15'),
    ('000110', 'MA2100', 20, 1.00, '2021-10-15', '2023-01-25'),
    ('000010', 'MA2110', 10, 1.00, '2018-08-10', '2020-02-10'),
    ('000200', 'MA2111', 50, 1.00, '2019-01-01', '2020-12-15'),
    ('000200', 'MA2111', 60, 1.00, '2019-01-15', '2020-12-10'),
    ('000150', 'MA2112', 60, 1.00, '2020-01-01', '2021-12-01'),
    ('000170', 'MA2112', 60, 1.00, '2020-01-01', '2021-11-20'),
    ('000170', 'MA2112', 70, 1.00, '2020-02-01', '2021-12-15'),
    ('000190', 'MA2112', 70, 1.00, '2020-02-15', '2021-12-01'),
	
	--51
	('000190', 'MA2112', 80, 1.00, '2020-02-25', '2021-12-25'),
	('000160', 'MA2113', 60, 1.00, '2017-02-15', '2020-02-01'),
	('000170', 'MA2113', 80, 1.00, '2017-02-20', '2019-12-20'),
	('000180', 'MA2113', 70, 1.00, '2017-03-01', '2019-12-15'),
	('000210', 'MA2113', 80, 0.50, '2017-02-15', '2019-12-01'),
	('000210', 'MA2113', 180, 0.50, '2019-03-01', '2020-02-01'),
	('000050', 'OP1000', 10, 0.25, '2020-01-10', '2020-03-01'),
	('000090', 'OP1010', 10, 1.00, '2020-04-01', '2021-12-15'),
	('000280', 'OP1010', 130, 1.00, '2020-04-10', '2021-12-01'),
	('000290', 'OP1010', 130, 1.00, '2020-05-01', '2022-01-01'),
	
	--61
	('000300', 'OP1010', 130, 1.00, '2020-05-01', '2021-02-01'),
	('000310', 'OP1010', 130, 1.00, '2020-04-01', '2021-12-01'),
	('000050', 'OP2010', 10, 0.75, '2020-05-01', '2021-02-01'),
	('000100', 'OP2010', 10, 1.00, '2020-05-05', '2021-02-01'),
	('000320', 'OP2011', 140, 0.75, '2018-07-10', '2020-02-25'),
	('000320', 'OP2011', 150, 0.25, '2018-07-10', '2020-02-25'),
	('000330', 'OP2012', 140, 0.25, '2018-09-01', '2021-02-01'),
	('000340', 'OP2013', 140, 0.50, '2020-02-10', '2022-02-01'),
	('000340', 'OP2013', 170, 0.50, '2020-02-15', '2022-02-20'),
	('000020', 'PL2100', 30, 1.00, '2017-07-15', '2020-12-15');

SELECT * FROM DEPARTMENT;
SELECT * FROM EMPLOYEE;
SELECT * FROM PROJECT;
SELECT * FROM EMP_ACT;

drop table EMP_ACT;

--ON DEPARTMENT
alter table DEPARTMENT
	add 
		--admin report foreing key, references department no
		constraint FK_ADMRDEPT 
		foreign key(ADMRDEPT) 
		references DEPARTMENT(DEPTNO),

		--manager foreign key, references employee no
		constraint FK_MGRNO
		foreign key(MGRNO)
		references EMPLOYEE(EMPNO);


--ON EMPLOYEE
-- work dept foreign key, references department no
alter table EMPLOYEE
	add constraint FK_WORKDEPT
	foreign key(WORKDEPT)
	references DEPARTMENT(DEPTNO);

--ON PROJECT
alter table PROJECT
	add 
		-- dep no foreign key, references department no
		constraint FK_DEPTNO
		foreign key(DEPTNO)
		references DEPARTMENT(DEPTNO),

		-- responsible employee foreign key, references employee no
		constraint FK_RESPEMP
		foreign key(RESPEMP)
		references EMPLOYEE(EMPNO);

	
-- ON EMP_ACT
alter table EMP_ACT
	add 
		--add employee no foreign key, references employee no
		constraint FK_EMPNO
		foreign key(EMPNO)
		references EMPLOYEE(EMPNO),

		--add proj no foreign key, references project no
		constraint FK_PROJNO
		foreign key(PROJNO)
		references PROJECT(PROJNO);

 SELECT * FROM EMP_ACT WHERE EMSTDATE BETWEEN '2011-10-01' AND '2011-10-31'\

 SELECT MIN(EMSTDATE), MAX(EMSTDATE) FROM EMP_ACT;

 SELECT * FROM EMP_ACT WHERE PROJNO = 'AD3111';